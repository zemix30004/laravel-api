

Чтобы сохранить копию базы данных:

Экспортирование и импортирование дампов баз данных
Дамп базы данных – это файл, содержащий структуру и контент базы данных. Его можно использовать для целей резервного копирования. В более ранних версиях Plesk дампы можно было создавать только с помощью инструментов управления базами данных. Теперь в Plesk есть более быстрый способ создавать дампы баз данных, хранить их и разворачивать ранее созданные дампы на сервере.

В Plesk экспортировать дамп базы данных означает сохранить исходную базу данных в виде файла, который затем можно будет хранить или распространять. Импортировать дамп базы данных означает восстановить данные из такого файла в конечную базу данных. Импорт можно выполнять как на текущий, так и на другой сервер баз данных. Единственное ограничение состоит в том, что исходная и конечная базы данных должны быть одного типа, например, MySQL.

В Plesk дампы баз данных создаются в формате SQL и хранятся в виде ZIP-архивов. Если вам нужно создать дамп в другом формате или с индивидуальными настройками, используйте собственную функциональность инструментов управления базами данных (phpMyAdmin, phpPgAdmin или myLittleAdmin). Инструкции по импорту и экспорту данных с помощью инструментов управления базами данных смотрите в справке к этим инструментам.

Перейдите на страницу Сайты и домены > Базы данных > Экспортировать резервную копию в окне инструментов управления базой данных.
Сохранить дамп:
Чтобы сохранить дамп в определенной папке на сервере, выберите папку. По умолчанию используется домашняя папка вашей подписки.
Чтобы сохранить дамп и на сервере, и на вашем локальном компьютере, выберите Автоматически скачать резервную копию после создания.
Чтобы развернуть копию базы данных в Plesk:

Перейдите на страницу Сайты и домены > Базы данных > Импортировать резервную копию в окне инструментов управления базой данных.
Выберите дамп для развертывания:
Чтобы развернуть дамп с вашего локального компьютера, выберите Загрузить и нажмите Просмотр. Затем выберите ZIP-архив с файлом дампа.
Чтобы развернуть дамп из папки на сервере, выберите Импортировать и выберите файл дампа.
Чтобы развернуть дамп во вновь созданной базе данных, выберите Заново создать базу данных. Старая база данных будет удалена, а новая с таким же именем – создана.
Что такое дамп базы данных MySQL и как его сделать?
MySQL - самая популярная БД в наше время для блогов, скриптов. Процесс дампа базы знаком и полезен каждому веб-мастеру и многим клиентам. Это и неудивительно, ведь эта процедура выполняется в рамках резервного копирования или переноса базы данных на другой хостинг или компьютер.

Следовательно, умение делать dump базы данных немаловажно для любого веб-разработчика. Что это такое? Это файл, содержащий инструкции на языке SQL, за счет которых создается точная копия вашей БД как по содержанию, так и по структуре. Для каких случаев вам стоит сделать дамп базы MySQL:

Перенести БД на другой сервер.
Dump может понадобиться, если вы запланировали миграцию БД на другой хостинг. С инструмента помощью вы сможете без каких-либо трудностей воссоздать точную копию старой базы данных.

Быстро создавать резервную копию.
Виртуальный хостинг сайтов, на котором включено ежедневное резервное копирование. Регулярное резервное копирование данных сэкономит вам немало сил и нервов в случае непредвиденных ситуаций. Неудачный эксперимент с сайтом способен привести к потере всей базы, и лишь вовремя сделанный дамп поможет вам в решении этой проблемы. Естественно, при этом его нельзя хранить на одном сервере с основной базой, ведь в противном случае вы потеряете всю информацию без возможности ее восстановления.

Как создать дамп базы без ошибок?
Существуют различные способы создания дампа, и далее мы рассмотрим основные варианты:

Делаем при помощи консоли MySQL
В этом случае для создания SQL дампа БД используется командная строка или консоль MySQL. Выполните подключение по SSH и введите команду "mysqldump", запустите утилиту и укажите специальные параметры:

mysqldump -uuser -ppass db_name > file_to_save.
При этом значение user - это имя пользователя БД с достаточными правами для создания дампа, pass - пароль от базы данных, db_name - имя нужной БД (database), а file_to_save указывает имя файла, куда будет сохраняться dump с содержимым в результате успешного выполнения. Информация в файле находится в формате SQL с ключами, записями (строками) и служебными комментариями.

После правильно введенной команды в указанном месте появится файл с расширением .sql, который и является дампом базы данных. Этот способ наиболее универсален и популярен среди пользователей Unix-систем, например, Ubuntu, если вдруг потребуется перенос БД.

Файл можно открыть в текстовом редакторе, как пример, для поиска записей и строк по части слова или темы. Обратите внимание, что не все редакторы поддерживают файлы больших размеров.

В том же случае, если вы не знаете консольных команд, вам потребуется дополнительное программное обеспечение.

Воспользуемся инструментом phpMyAdmin, чтобы создать один или несколько новых дампов.
Если вы предпочитаете использовать дополнительное программное обеспечение, то можно создать dump базы данных средствами PHP при помощи, например, phpMyAdmin. Для этого выполните следующие действия:

Войдите в панель управления phpMyAdmin.
Выберите нужную SQL базу данных из общего списка по названию.
Авторизуйтесь в выбранной БД.
После авторизации в левой колонке будет сама база данных и служебная информация, которая к ней относится. Теперь вам нужно повторно выбрать вашу БД.
Перейдите во вкладку "Экспорт", после чего включите некоторые настройки, а именно:
- Добавить SQL строчку "DROP TABLE/VIEW/PROCEDURE/FUNCTION/EVENT"

Нажать соответствующую кнопку.

Данная опция позволяет вам в дальнейшем без ошибок восстановить базу MySQL из дампа. Все таблицы, имеющие одинаковые имена, сначала будут удалены, то есть исполнится команда DROP, а затем заменятся на аналогичные из вашего дампа. В итоге вы обезопасите себя от создания дублей таблиц и как следствие, неправильной работы базы данных.

- Упаковать .zip, .gz или .gzip;

Включение этой опции обеспечит архивацию вашего SQL дампа БД, и в итоге вы получите файл с расширением .zip. Это позволит вам быстрее и корректнее сохранить новый дамп даже при невысокой скорости соединения.

Получаете готовый к использованию SQL дамп БД. Если все было правильно сделано, то у вас будет архив, внутри которого находится файл с расширением .sql в виде дампа нужной вам базы данных.
Теперь вы знаете, как сделать полный дамп, если вам вдруг потребуется перенос базы на другой сервер или возникнет любая другая ситуация, когда может пригодиться резервная копия БД. Конечно, существует еще достаточно много способов создания дампа, помимо описанных выше. Но даже владение самыми простыми вариантами и регулярное применение их на практике позволит вам более уверенно чувствовать себя в любой непредвиденной ситуации, ведь достаточно будет просто развернуть дамп MySQL и сразу восстановить все базы данных.

Если вы решились купить dedicated server в нашей компании, то Вам выдается 100 ГБ на удаленном хранилище бекапов, куда можно настроить автоматическое резервное копирование информации. В таком случае, у вас всегда будет свежий дамп.

Важная информация: Не храните и не публикуйте файлы с доступом по ссылке. Вся информацию (data) необходимо хранить в надежном месте.

В том случае, когда у вас все же возникают сложности при создании дампа - обратитесь к сотрудникам техподдержки RigWEB, и они ответят на любые ваши вопросы в рамках своей компетенции. Если же вы по каким-то причинам не можете заниматься этим самостоятельно, наши специалисты бесплатно займутся переносом содержимого с другого хостинга на наш. Также мы обеспечим регулярное резервное копирование и своевременное предоставление актуальных копий ваших данных при необходимости. Пользуясь профессиональным хостингом RigWEB, вы можете быть уверены в максимальной защите своего проекта от любых неожиданностей!

Дамп базы данных
Термины
Редактор: Дмитрий Сокол
596
18 мин
Аудио
Что такое дамп базы данных
Дамп базы данных - это сохранение информации из базы данных в текстовом SQL-файле. 

Web-сайты состоят из файлов и базы данных. Именно в базе данных хранится вся часто изменяемая информация сайта:

имена пользователей и их настройки;
товары для интернет-магазина;
статьи для новостного портала.
Если нужно перенести информацию сайта на другой хостинг или создать резервную копию, то используются дампы базы данных.

Текстовый файл содержит всю информацию, хранящуюся в исходной базе данных, и может быть импортирован в другую базу данных.

Файлы с дампами имеют тип .SQL. Их размеры могут достигать сотен мегабайт для больших нагруженных сайтов. 



Пример содержимого текстового файла с дампом базы данных. Видно, что файл состоит из отдельных команд языка SQL

Работа с дампом базы данных MySQL
MySQL - это один из самых популярных серверов управления базами данных, который активно используется для создания web-сайтов.

Как индустриальный стандарт MySQL поддерживается у всех провайдеров хостинга. Популярные CMS Wordpress, Joomla, Bitrix используют в качестве хранилища информации именно MySQL.

На виртуальном хостинге пользователь не имеет доступа на сервер и не может работать с командной строкой, поэтому для него остается вариант работы с дампами базы данных с использованием web-интерфейса, который либо встроен в панель управления хостинга, либо предоставляется утилитой phpMyAdmin.

Чтобы получить дамп базы данных MySQL на VPS/VDS и выделенном сервере, можно воспользоваться командной строкой сервера или специальным web-интерфейсом. 

Использование функций панели управления
На примере провайдера Reg.ru и панели ISPManager разберем, как сделать дамп базы данных.

1. Зайдите в меню “Базы данных”. 
2. Нажмите на кнопку “Скачать”, чтобы скачать дамп базы данных на локальный компьютер. 



3. Чтобы импортировать дамп базы данных с локального компьютера на сервер, перейдите в раздел “Закачать” и нажмите на кнопку “Выберите файл”. Затем выберите файл с дампом на компьютере и запустите процесс закачки файла на сервер нажатием кнопки “Ok”.



Также имеется пункт меню “Локальный дамп”, который позволяет осуществить процедуру импорта дампа базы данных из предварительного закачанного на сервер файла. Достаточно просто найти и выбрать предварительно загруженный файл с дампом в одном из каталогов сайта:



Функция “Локальный дамп” полезна для тех случаев, когда нужно импортировать большой файл с дампом размером в несколько сотен мегабайт. Процедура импорта с файла на сервере работает намного быстрее, чем импорт файла с локального компьютера.

Использование web-интерфейса PHPMyAdmin
Практически у всех провайдеров виртуального хостинга в панель управления хостингом включена утилита PHPMyAdmin. Она используется в качестве удобного web-интерфейса для работы с базой данных MySQL. Например, у провайдера Beget ссылка на запуск phpMyAdmin располагается в разделе управления базами данных:



В числе прочих функций в PHPMyAdmin встроен механизм получения дампа базы данных. Для этого следует воспользоваться пунктом меню “Экспорт”:



PHPMyAdmin по умолчанию экспортирует информацию из базы данных в формате текстового дампа SQL. Кнопка “Вперед” сохраняет на локальный компьютер текстовый файл с типом .SQL, в котором и находится нужный вам дамп базы данных. 



При просмотре этого файла в блокноте видно, что он состоит из отдельных команд SQL

Обратной операцией по отношению к экспорту дампа базы данных является восстановление данных из этого дампа. Для этого в PHPMyAdmin нужно воспользоваться меню “Импорт”:



Кнопкой “Choose file” выбирается нужный файл на локальном компьютере, после нажатия кнопки “Вперед” происходит процедура импорта.

Перед началом процедуры импорта дампа базы данных сайта, рекомендуем убедиться в том, что база данных, в которую будет делаться импорт, - пустая и не содержит никаких таблиц. Это поможет избежать возможных ошибок при импорте, связанных с тем, что таблица с определенным названием уже существует в данной базе данных.

Таким образом, web-интерфейс работы с базой данных PHPMyAdmin можно применять как для создания дампа базы данных, так и для его импорта. PHPMyAdmin возможно установить и на свой виртуальный или выделенный сервер вместе с другим программным обеспечением. Кроме того, такие популярные панели управления хостингом, как VestaCP или ISPManager, также предоставляют этот web-интерфейс.

К недостаткам использования PHPMyadmin можно отнести возможные проблемы при работе с дампами очень больших баз данных размерами в сотни мегабайт. Импорт большого дампа связан с ограничениями web-сервера и PHP на размер загружаемого файла, и может потребовать предварительно разделить его на несколько частей, что представляет собой кропотливую и трудоемкую работу.

phpMyAdmin позволяет провести импорт дампа базы данных, предварительно упакованного в архив формата .zip или .tgz. Эту хитрость рекомендуется использовать, если нужно провести импорт очень большого файла размером в сотни мегабайт, который после упаковки в архив станет намного меньше.

phpMyAdmin является специализированным программным обеспечением для работы с базами данных MySQL. Конкретно с дампами SQL работать с помощью phpMyAdmin удобнее для привыкших к его интерфейсу пользователей. К тому же эта утилита предоставляет подробную диагностику ошибок импорта в случае их возникновения. В то же время, если у провайдера есть в панели управления свои специальные средства для импорта и экспорта дампов, то их использование может быть проще для обычного пользователя.

Использование командной строки сервера
Для владельцев виртуальных и выделенных серверов доступна возможность работы с дампами базы данных из командной строки сервера. Этот метод лишен ограничений по размеру файла с дампом, работает быстро и надежно.

Для создания дампа пользователю необходимо знать название базы данных, имя пользователя и пароль. Сохранить данные в дамп можно утилитой mysqldump.

Синтаксис команды для создания дампа:

mysqldump -u username -p databasename > filename.sql

username - это имя пользователя базы данных;
databasename - название базы данных;
filename - имя создаваемого текстового файла с дампом. 
Желательно присваивать этому файлу тип .SQL.
 
При запуске описанной команды будет запрошен пароль к базе данных для конкретного пользователя. После его ввода система сохранит все данные в файл с указанным названием.



Пример: после запуска процедуры создания дампа командой mysqldump, с помощью команды “ls” проверили, что в папке сайта появился файл dump.sql с дампом базы данных.

Для импорта дампа базы данных нужно будет воспользоваться командой “mysql” с синтаксисом:

mysql -u username -p databasename < filename.sql

username - это имя пользователя;
databasename - имя базы данных;
filename.sql - название файла с дампом.
Система запросит пароль к базе данных и выполнит процедуру импорта.



Пример: восстановление базы данных командой mysql из файла с дампом dump.sql

Если при работе процедуры импорта на экран не было выведено никаких сообщений об ошибке, то, значит, импорт состоялся успешно, и все данные из дампа уже находятся в базе данных. Эта операция называется “восстановить базу из дампа”.

Работа с дампом базы PostgreSQL
PostgreSQL - это популярный у профессиональных программистов сервер управления базами данных, аналогично с MySQL применяющийся в разработке web-сайтов. Точно так же, как при использовании MySQL, при работе с Postgres возникает необходимость создания дампов базы данных и импорта дампа обратно в базу.

С Postgres работают на виртуальных и выделенных серверах.

В командной строке создать дамп базы PostgreSQL можно командой pg_dump с синтаксисом:

pg_dump -U username databasename > filename.sql

username - это имя пользователя
PostgreSQL, databasename - название базы данных,
filename - название файла, куда сохраняется дамп.


Пример: после использования команды pg_dump дамп базы данных сохранен в файл dump.sql

Для импорта дампа в базу данных используется команда psql с синтаксисом:

psql -U username databasename < filename.sql

username - это имя пользователя;
PosgreSQL, databasename - название базы данных;
filename - название файла, куда сохраняется дамп.


Пример: использование команды psql для импорта дампа в базу данных

Также создавать дампы в PostgreSQL можно через web-интерфейс phpPgAdmin (работает аналогично phpMyAdmin для MySQL)

Создание дампа делается через меню “Export”. На экране экспорта выбирается опции “Structure and Data” и “Download”, затем нажимается кнопка “Export”. На локальный компьютер сохраняется текстовый файл с дампом.



Для обратной операции импорта данных из файла с дампом в базу данных в phpPgAdmin используется меню “SQL”. 

На экране SQL выбирается файл с дампом с помощью кнопки “Choose File”, затем нажимается кнопка “Execute”. 

После этого данные из файла с дампом импортируются в базу данных:



Выводы
Работа с дампом базы данных широко используется для администрирования и обслуживания web-сайтов. Возможность сохранения дампа базы данных и восстановления из него информации незаменима при работе с резервными копиями сайтов, при миграции сайтов на другой хостинг и удобна во многих других случаях.

Выполнять операции по сохранению и восстановлению дампов баз данных при использовании услуги виртуального хостинга можно через web-интерфейс панели управления хостингом или утилиту phpMyAdmin, а на виртуальных и выделенных серверах - также из командной строки. 

Дмитрий СоколРедактор материала • Дмитрий Сокол
Хостинг-эксперт (опыт работы 12 лет)
Основная специализация - составление обзоров хостинг-провайдеров, написание статей и составление рейтингов. Верит, что невозможное - возможно и убеждает всех: "круто делай - круто получится!".